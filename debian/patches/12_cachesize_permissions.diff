diff --git a/ccache.c b/ccache.c
index 290c688..8ed9892 100644
--- a/ccache.c
+++ b/ccache.c
@@ -1048,15 +1048,23 @@ static int ccache_main(int argc, char *argv[])
 		case 'F':
 			check_cache_dir();
 			v = atoi(optarg);
-			stats_set_limits(v, -1);
-			printf("Set cache file limit to %u\n", (unsigned)v);
+			if (stats_set_limits(v, -1) == 0) {
+				printf("Set cache file limit to %u\n", (unsigned)v);
+			} else {
+				printf("Could not set cache file limit.\n");
+				exit(1);
+			}
 			break;
 
 		case 'M':
 			check_cache_dir();
 			v = value_units(optarg);
-			stats_set_limits(-1, v);
-			printf("Set cache size limit to %uk\n", (unsigned)v);
+			if (stats_set_limits(-1, v) == 0) {
+				printf("Set cache size limit to %uk\n", (unsigned)v);
+			} else {
+				printf("Could not set cache size limit.\n");
+				exit(1);
+			}
 			break;
 
 		default:
diff --git a/ccache.h b/ccache.h
index 8d3c93c..bd67cbc 100644
--- a/ccache.h
+++ b/ccache.h
@@ -118,7 +118,7 @@ void stats_zero(void);
 void stats_summary(void);
 void stats_tocache(size_t size);
 void stats_read(const char *stats_file, unsigned counters[STATS_END]);
-void stats_set_limits(long maxfiles, long maxsize);
+int stats_set_limits(long maxfiles, long maxsize);
 size_t value_units(const char *s);
 void display_size(unsigned v);
 void stats_set_sizes(const char *dir, size_t num_files, size_t total_size);
diff --git a/stats.c b/stats.c
index e5662fb..ddaf768 100644
--- a/stats.c
+++ b/stats.c
@@ -286,7 +286,7 @@ void stats_zero(void)
 
 
 /* set the per directory limits */
-void stats_set_limits(long maxfiles, long maxsize)
+int stats_set_limits(long maxfiles, long maxsize)
 {
 	int dir;
 	unsigned counters[STATS_END];
@@ -298,7 +298,9 @@ void stats_set_limits(long maxfiles, long maxsize)
 		maxsize /= 16;
 	}
 
-	create_dir(cache_dir);
+	if (create_dir(cache_dir) != 0) {
+		return 1;
+	}
 
 	/* set the limits in each directory */
 	for (dir=0;dir<=0xF;dir++) {
@@ -306,7 +308,9 @@ void stats_set_limits(long maxfiles, long maxsize)
 		int fd;
 
 		x_asprintf(&cdir, "%s/%1x", cache_dir, dir);
-		create_dir(cdir);
+		if (create_dir(cdir) != 0) {
+			return 1;
+		}
 		x_asprintf(&fname, "%s/stats", cdir);
 		free(cdir);
 
@@ -326,6 +330,8 @@ void stats_set_limits(long maxfiles, long maxsize)
 		}
 		free(fname);
 	}
+
+	return 0;
 }
 
 /* set the per directory sizes */
